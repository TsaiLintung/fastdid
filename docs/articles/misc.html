<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fastdid">
<title>misc • fastdid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="misc">
<meta property="og:description" content="fastdid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fastdid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/double.html">double</a>
    <a class="dropdown-item" href="../articles/misc.html">misc</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TsaiLintung/fastdid/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>misc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TsaiLintung/fastdid/blob/HEAD/vignettes/misc.Rmd" class="external-link"><code>vignettes/misc.Rmd</code></a></small>
      <div class="d-none name"><code>misc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p><code>fastdid</code> is magnitudes faster than <a href="https://github.com/bcallaway11/did" class="external-link">did</a>, and 15x faster than
the fastest alternative <a href="https://github.com/setzler/DiDforBigData" class="external-link">DiDforBigData</a> (dfbd
for short) for large dataset. fastdid also uses less memory. Here is a
comparison of run time for fastdid, did, and dfbd using a panel of 10
periods and varying samples sizes.</p>
<p><img src="https://i.imgur.com/s5v32Rw.png"></p>
<p>Unfortunately, the Author’s computer fails to run
<strong>did</strong> at 1 million units. For a rough idea,
<strong>DiDforBigData</strong> is about 100x faster than
<strong>did</strong> in Bradley Setzler’s <a href="https://setzler.github.io/DiDforBigData/articles/Background.html" class="external-link">benchmark</a>.
Other staggered DiD implementations are even slower than
<strong>did</strong>.</p>
<p>For memory:</p>
<p><img src="https://i.imgur.com/7emkgOz.png"></p>
<p>For the benchmark, a baseline group-time ATT is estimated with no
covariates control, no bootstrap, and no explicit parallelization.
Computing time is measured by <code>microbenchmark</code> and peak RAM
by <code>peakRAM</code>.</p>
</div>
<div class="section level2">
<h2 id="validitiy">Validitiy<a class="anchor" aria-label="anchor" href="#validitiy"></a>
</h2>
<p>Before each release, we conduct tests to ensure the validity of
estimates from <code>fastdid</code>.</p>
<div class="section level3">
<h3 id="basics-comparison-with-did">Basics: comparison with <code>did</code><a class="anchor" aria-label="anchor" href="#basics-comparison-with-did"></a>
</h3>
<p>For features included in CS, <code>fastdid</code> maintains a maximum
of 1% difference from results from the <code>did</code> package. This
margin of error is mostly for bootstrapped results due to its inherent
randomess. For point estimates, the difference is smaller than 1e-12,
and is most likely the result of <a href="https://en.wikipedia.org/wiki/Floating-point_error_mitigation" class="external-link">floating-point
error</a>. The relevant test files are <a href="https://github.com/TsaiLintung/fastdid/blob/main/inst/tinytest/test_2_compare_gt.R" class="external-link">group-time</a>
and <a href="https://github.com/TsaiLintung/fastdid/blob/main/inst/tinytest/test_3_compare_agg.R" class="external-link">aggregates</a>.</p>
</div>
<div class="section level3">
<h3 id="extensions-coverage-test">Extensions: coverage test<a class="anchor" aria-label="anchor" href="#extensions-coverage-test"></a>
</h3>
<p>For features not included in CS, <code>fastdid</code> maintains that
the 95% confidence intervals have a coverage rate between 94% and
96%.</p>
<p>The coverage rate is calculated by running 200 iterations. In each
iteration, we test whether the confidence interval estimated covers the
group-truth values. We then average the rate across iterations. Due to
the randomness of coverage, the realized coverage fall outside of the
thresholds in about 1% of the time. The relevant test file is <a href="https://github.com/TsaiLintung/fastdid/blob/main/inst/tinytest/test_5_coverage.R" class="external-link">coverage</a>.</p>
</div>
<div class="section level3">
<h3 id="experimental-features-not-tested">Experimental Features: not tested<a class="anchor" aria-label="anchor" href="#experimental-features-not-tested"></a>
</h3>
<p>As an attempt to balance the validity and flexibility of
<code>fastdid</code>, “experimental features” is introduced in version
0.9.4. These features will be less tested and documented, and it is
generally advised to not use them unless the user know what they and the
package are doing. These experimental features can be accessed via the
<code>exper</code> argument. For example, to use the
<code>filtervar</code> feature, call
<code>fastdid(..., exper = list(filtervar = "FF"))</code>.</p>
<p>The current list of experimental features are</p>
<ul>
<li>
<code>max_control_cohort_diff</code>: limit the max cohort
difference between treated and control group</li>
<li>
<code>filtervar</code>, <code>filtervar_post</code>: limit the units
being used as treated and control group with a potentially-time-varying
variable in base (post) period</li>
<li>
<code>only_balance_2by2</code>: only require observations to have
non-NA values within each 2 by 2 DiD, instead of throughout all time
periods. Can be an alternative way of dealing with unbalanced panel by
filling the missing periods with NAs. Not recommended as CS only have
<code>allow_unbalance_panel</code>, which uses a repeated cross-section
2 by 2 DiD estimator.</li>
<li>
<code>custom_scheme</code>: aggregate to user-defined
parameters</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-did">Comparison with <code>did</code><a class="anchor" aria-label="anchor" href="#comparison-with-did"></a>
</h2>
<p>As the name suggests, <strong>fastdid</strong>’s goal is to be fast
<strong>did</strong>. Besides performance, here are some comparisons
between the two packages.</p>
<div class="section level3">
<h3 id="estimator">Estimator<a class="anchor" aria-label="anchor" href="#estimator"></a>
</h3>
<p><strong>fastdid</strong>’s estimators is identical to
<strong>did</strong>’s. As the performance gains mostly come from
efficient data manipulation, the key estimation implementations are
analogous. For example, 2x2 DiD (<code>estimate_did.R</code> and
<code><a href="https://psantanna.com/DRDID/reference/std_ipw_did_panel.html" class="external-link">DRDID::std_ipw_did_panel</a></code>), influence function from weights
(<code>aggregate_gt.R/get_weight_influence</code>,
<code>compute.aggte.R/wif</code>), and multiplier bootstrap
(<code>get_se.R</code> and <code>mboot.R</code>).</p>
</div>
<div class="section level3">
<h3 id="interface">Interface<a class="anchor" aria-label="anchor" href="#interface"></a>
</h3>
<p><strong>fastdid</strong> should feel similar to <code>att_gt</code>.
But there are a few differences:</p>
<p>Control group option:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr>
<th>fastdid</th>
<th>did</th>
<th>control group used</th>
</tr></thead>
<tbody>
<tr>
<td>both</td>
<td>notyettreated</td>
<td>never-treated + not-yet-but-eventually-treated</td>
</tr>
<tr>
<td>never</td>
<td>nevertreated</td>
<td>never-treated</td>
</tr>
<tr>
<td>notyet</td>
<td></td>
<td>not-yet-but-eventually-treated</td>
</tr>
</tbody>
</table>
<p>Aggregated parameters: <code>fastdid</code> aggregates in the same
function.</p>
<table class="table">
<thead><tr>
<th>fastdid</th>
<th>did</th>
</tr></thead>
<tbody>
<tr>
<td>group_time</td>
<td>no aggregation</td>
</tr>
<tr>
<td>dynamic</td>
<td>dynamic</td>
</tr>
<tr>
<td>time</td>
<td>calendar</td>
</tr>
<tr>
<td>group</td>
<td>group</td>
</tr>
<tr>
<td>simple</td>
<td>simple</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="other">Other<a class="anchor" aria-label="anchor" href="#other"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>fastdid</strong> only offers inverse probability weights
estimators for controlling for covariates when allowing for unbalanced
panels.</li>
<li>
<strong>fastdid</strong> use universal base periods as default.</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lin-Tung Tsai.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
